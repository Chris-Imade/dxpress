<!-- Invoice Management -->
<div class="dashboard-card" style="margin-bottom: 24px;">
    <div class="card-header">
        <div class="card-icon">
            <i class="fas fa-file-invoice-dollar"></i>
        </div>
        <div>
            <div class="card-title">Invoice Management</div>
            <div class="card-subtitle">Manage and download your shipping invoices</div>
        </div>
        <div style="margin-left: auto; display: flex; gap: 12px;">
            <button class="btn btn-secondary" onclick="exportInvoices()">
                <i class="fas fa-download"></i>
                Export All
            </button>
            <button class="btn btn-primary" onclick="createInvoice()">
                <i class="fas fa-plus"></i>
                Create Invoice
            </button>
        </div>
    </div>
</div>

<!-- Invoice Stats -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 24px;">
    <div class="stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
            <i class="fas fa-dollar-sign"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number">$24,567</div>
            <div class="stat-label">Total Revenue</div>
            <div class="stat-change positive">+15% this month</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">
            <i class="fas fa-file-alt"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number">142</div>
            <div class="stat-label">Total Invoices</div>
            <div class="stat-change positive">+8 this week</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
            <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number">12</div>
            <div class="stat-label">Pending Payment</div>
            <div class="stat-change negative">+3 overdue</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
            <i class="fas fa-percentage"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number">94.2%</div>
            <div class="stat-label">Collection Rate</div>
            <div class="stat-change positive">+2.1% this month</div>
        </div>
    </div>
</div>

<!-- Filters and Search -->
<div class="dashboard-card" style="margin-bottom: 24px;">
    <div style="display: flex; flex-wrap: wrap; gap: 16px; align-items: center;">
        <div style="flex: 1; min-width: 250px;">
            <input type="text" id="searchInvoices" placeholder="Search invoices..." style="width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 14px;">
        </div>
        <div>
            <select id="statusFilter" style="padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 14px;">
                <option value="">All Status</option>
                <option value="paid">Paid</option>
                <option value="pending">Pending</option>
                <option value="overdue">Overdue</option>
                <option value="draft">Draft</option>
            </select>
        </div>
        <div>
            <select id="dateFilter" style="padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 14px;">
                <option value="">All Time</option>
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
                <option value="quarter">This Quarter</option>
            </select>
        </div>
        <button class="btn btn-secondary" onclick="applyFilters()">
            <i class="fas fa-filter"></i>
            Apply Filters
        </button>
    </div>
</div>

<!-- Invoices Table -->
<div class="dashboard-card">
    <div class="card-header">
        <div class="card-icon">
            <i class="fas fa-list"></i>
        </div>
        <div>
            <div class="card-title">Recent Invoices</div>
            <div class="card-subtitle">Manage your shipping invoices</div>
        </div>
    </div>
    <div style="margin-top: 20px; overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Invoice #</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Customer</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Amount</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Status</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Date</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #374151;">Due Date</th>
                    <th style="padding: 16px; text-align: center; font-weight: 600; color: #374151;">Actions</th>
                </tr>
            </thead>
            <tbody id="invoicesTableBody">
                <tr style="border-bottom: 1px solid #f3f4f6;">
                    <td style="padding: 16px; font-weight: 600; color: #032330;">#INV-2024-001</td>
                    <td style="padding: 16px;">
                        <div style="font-weight: 600; color: #374151;">Acme Corporation</div>
                        <div style="font-size: 12px; color: #6b7280;">john@acme.com</div>
                    </td>
                    <td style="padding: 16px; font-weight: 600; color: #032330;">$1,245.50</td>
                    <td style="padding: 16px; text-align: right;">
                        <span class="status-badge paid">Paid</span>
                    </td>
                    <td style="padding: 16px; color: #6b7280;">Dec 15, 2024</td>
                    <td style="padding: 16px; color: #6b7280;">Dec 30, 2024</td>
                    <td style="padding: 16px; text-align: center;">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button class="action-btn" onclick="viewInvoice('INV-2024-001')" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn" onclick="downloadInvoice('INV-2024-001')" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="sendInvoice('INV-2024-001')" title="Send">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid #f3f4f6;">
                    <td style="padding: 16px; font-weight: 600; color: #032330;">#INV-2024-002</td>
                    <td style="padding: 16px;">
                        <div style="font-weight: 600; color: #374151;">Tech Solutions Inc</div>
                        <div style="font-size: 12px; color: #6b7280;">billing@techsol.com</div>
                    </td>
                    <td style="padding: 16px; font-weight: 600; color: #032330;">$892.75</td>
                    <td style="padding: 16px; text-align: right;">
                        <span class="status-badge pending">Pending</span>
                    </td>
                    <td style="padding: 16px; color: #6b7280;">Dec 18, 2024</td>
                    <td style="padding: 16px; color: #6b7280;">Jan 2, 2025</td>
                    <td style="padding: 16px; text-align: center;">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button class="action-btn" onclick="viewInvoice('INV-2024-002')" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn" onclick="downloadInvoice('INV-2024-002')" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="sendInvoice('INV-2024-002')" title="Send">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid #f3f4f6;">
                    <td style="padding: 16px; font-weight: 600; color: #032330;">#INV-2024-003</td>
                    <td style="padding: 16px;">
                        <div style="font-weight: 600; color: #374151;">Global Logistics</div>
                        <div style="font-size: 12px; color: #6b7280;">accounts@globallog.com</div>
                    </td>
                    <td style="padding: 16px; font-weight: 600; color: #032330;">$2,156.25</td>
                    <td style="padding: 16px; text-align: right;">
                        <span class="status-badge overdue">Overdue</span>
                    </td>
                    <td style="padding: 16px; color: #6b7280;">Nov 28, 2024</td>
                    <td style="padding: 16px; color: #ef4444;">Dec 13, 2024</td>
                    <td style="padding: 16px; text-align: center;">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button class="action-btn" onclick="viewInvoice('INV-2024-003')" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn" onclick="downloadInvoice('INV-2024-003')" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="sendReminder('INV-2024-003')" title="Send Reminder">
                                <i class="fas fa-exclamation-triangle"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<style>
.status-badge {
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    display: inline-block;
    white-space: nowrap;
    width: fit-content;
}

.status-badge.paid {
    background: #d1fae5;
    color: #065f46;
}

.status-badge.pending {
    background: #fef3c7;
    color: #92400e;
}

.status-badge.overdue {
    background: #fee2e2;
    color: #991b1b;
}

.status-badge.draft {
    background: #e5e7eb;
    color: #374151;
}

.action-btn {
    padding: 8px;
    background: #f3f4f6;
    border: none;
    border-radius: 6px;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.2s ease;
}

.action-btn:hover {
    background: #032330;
    color: white;
}
</style>

<script>
function viewInvoice(invoiceId) {
    console.log(`Viewing invoice ${invoiceId}`);
    window.open(`/dashboard/invoices/view/${invoiceId}`, '_blank');
}

function downloadInvoice(invoiceId) {
    console.log(`Downloading invoice ${invoiceId}`);
    const link = document.createElement('a');
    link.href = `/api/invoices/${invoiceId}/download`;
    link.download = `invoice-${invoiceId}.pdf`;
    link.click();
    showNotification(`Invoice ${invoiceId} downloaded successfully!`, 'success');
}

function sendInvoice(invoiceId) {
    console.log(`Sending invoice ${invoiceId}`);
    showNotification(`Invoice ${invoiceId} sent successfully!`, 'success');
}

function sendReminder(invoiceId) {
    console.log(`Sending reminder for invoice ${invoiceId}`);
    showNotification(`Payment reminder sent for invoice ${invoiceId}!`, 'warning');
}

function createInvoice() {
    window.location.href = '/dashboard/invoices/create';
}

function exportInvoices() {
    console.log('Exporting all invoices');
    showNotification('Exporting invoices... Download will start shortly.', 'info');
    
    setTimeout(() => {
        const link = document.createElement('a');
        link.href = '/api/invoices/export';
        link.download = 'invoices-export.xlsx';
        link.click();
    }, 2000);
}

function applyFilters() {
    const search = document.getElementById('searchInvoices').value;
    const status = document.getElementById('statusFilter').value;
    const date = document.getElementById('dateFilter').value;
    
    console.log('Applying filters:', { search, status, date });
    showNotification('Filters applied successfully!', 'info');
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 16px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 600;
        z-index: 10000;
        animation: slideIn 0.3s ease;
    `;
    
    const colors = {
        success: '#10b981',
        error: '#ef4444',
        warning: '#f59e0b',
        info: '#3b82f6'
    };
    notification.style.background = colors[type] || colors.info;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>
